

## 索引分类

常见的索引类型有：聚集（主键）索引、二级索引。所有非聚集索引之外的索引都被成为二级索引。

二级索引常见的包括：



### 聚集索引

聚集索引选择的三种情况：

- When you define a `PRIMARY KEY` on your table, `InnoDB` uses it as the clustered index. Define a primary key for each table that you create. If there is no logical unique and non-null column or set of columns, add a new [auto-increment](https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_auto_increment) column, whose values are filled in automatically.
- If you do not define a `PRIMARY KEY` for your table, MySQL locates the first `UNIQUE` index where all the key columns are `NOT NULL` and `InnoDB` uses it as the clustered index.
- If the table has no `PRIMARY KEY` or suitable `UNIQUE` index, `InnoDB` internally generates a hidden clustered index named `GEN_CLUST_INDEX` on a synthetic column containing row ID values. The rows are ordered by the ID that `InnoDB` assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.

### 二级索引

二级索引创建了表的字段子集，适合：比如你只需要表中的某个或者某几个字段，否则在更复杂的查询时需要进行回表操作





## 常见索引优化实例





## 索引常用命令

### 查询耗时时间

```
show variables like '%profiling%';

set profiling=ON;
show variables;

#
show profiles;

```

### 查询索引空间大小



```
SELECT TABLE_NAME AS '表名',
CONCAT(ROUND(TABLE_ROWS/10000, 2), ' 万行') AS '行数',
CONCAT(ROUND(DATA_LENGTH/(1024*1024*1024), 2), ' GB') AS '表空间',
CONCAT(ROUND(INDEX_LENGTH/(1024*1024*1024), 2), ' GB') AS '索引空间',
CONCAT(ROUND((DATA_LENGTH+INDEX_LENGTH)/(1024*1024*1024),2),' GB') AS'总空间'
FROM information_schema.TABLES 
```

### 查看缓存信息



```
# 是否打开缓存
show variables like 'have_query_cache'
# 使用此语句可以查看缓存的开关、大小等信息
show variables like 'query';　

# 当前缓存的情况
show status like '%Qcache%';

# 清理缓存
 flush query cache;
 reset query cache
```



## 索引测试



```

```



## 参考资料

Explain:	

https://dev.mysql.com/doc/refman/5.7/en/explain-output.html

MySQL执行计划

https://www.cnblogs.com/sunjingwu/p/10755823.html